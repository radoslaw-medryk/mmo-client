(()=>{"use strict";var t={344:(t,e,n)=>{n.r(e)},187:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.randomColor=void 0;var o=n(233);e.randomColor=function(){var t=o.randomNumber(0,256),e=o.randomNumber(0,256),n=o.randomNumber(0,256);return"#"+t.toString(16).padStart(2,"0")+e.toString(16).padStart(2,"0")+n.toString(16).padStart(2,"0")}},233:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.randomNumber=void 0,e.randomNumber=function(t,e){return Math.floor(Math.random()*(e-t))+t}},201:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.sure=void 0,e.sure=function(t){if(null==t)throw new Error("value === null || value === undefined");return t}},474:function(t,e,n){var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Canvas=void 0;var r=n(201),s=function(t){function e(e){var n=t.call(this)||this;n.visualConsts=e,n.canvas=document.createElement("canvas");var o=e.tileSize,i=e.chunkSize,s=o.pxWidth*i.tilesWidth,u=o.pxHeight*i.tilesHeight;return n.canvas.width=s,n.canvas.height=u,n.context=r.sure(n.canvas.getContext("2d")),n}return i(e,t),e.prototype.mount=function(e){t.prototype.mount.call(this,e,this.canvas)},e.prototype.unmount=function(){t.prototype.unmount.call(this,this.canvas)},e.prototype.fillTile=function(t,e,n){var o=this.visualConsts.tileSize,i=o.pxWidth*t,r=o.pxHeight*e;this.context.fillStyle=n,this.context.fillRect(i,r,o.pxWidth,o.pxHeight);var s=t+" / "+e;this.context.strokeStyle="#444",this.context.fillStyle="#fff",this.context.font="32px Arial",this.context.fillText(s,i+20,r+60),this.context.strokeText(s,i+20,r+60)},e}(n(923).Mountable);e.Canvas=s},37:function(t,e,n){var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Chunk=void 0;var r=n(907),s=n(474),u=function(t){function e(e,n){var o=t.call(this)||this;o.visualConsts=e,o.chunkSettings=n,o.container=document.createElement("div"),o.container.className="mmo-chunk";var i=r.getGamePxPosition(e,n.position),u=i.gamePxX,a=i.gamePxY;return o.container.style.left=u+"px",o.container.style.top=a+"px",o.canvas=new s.Canvas(e),o.canvas.mount(o.container),o}return i(e,t),e.prototype.mount=function(e){t.prototype.mount.call(this,e,this.container)},e.prototype.unmount=function(){t.prototype.unmount.call(this,this.container)},e.prototype.fillTile=function(t,e,n){this.canvas.fillTile(t,e,n)},e}(n(923).Mountable);e.Chunk=u},200:function(t,e,n){var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Layer=void 0;var r=n(187),s=n(37),u=n(923),a=n(879),c=n(698),l=function(t){function e(e){var n=t.call(this)||this;n.chunks=[],n.visualConsts=e,n.layerState={center:{gamePxX:0,gamePxY:0}},n.container=document.createElement("div"),n.container.className="mmo-layer";var o=c.getViewPortGamePxCoords(e,n.layerState).topLeft;return n.container.style.left=-o.gamePxX+"px",n.container.style.top=-o.gamePxY+"px",n}return i(e,t),e.prototype.mount=function(e){t.prototype.mount.call(this,e,this.container)},e.prototype.unmount=function(){t.prototype.unmount.call(this,this.container)},e.prototype.syncChunks=function(){var t=c.getViewPortGamePxCoords(this.visualConsts,this.layerState),e=a.getChunkPosition(this.visualConsts,t.topLeft),n=a.getChunkPosition(this.visualConsts,t.bottomRight);this.removeChunksOutside(e,n),this.createMissingChunksInside(e,n)},e.prototype.__paintChunksRandomly=function(){for(var t=0,e=this.chunks;t<e.length;t++)for(var n=e[t],o=0;o<6;o++)for(var i=0;i<6;i++)n.fillTile(o,i,r.randomColor())},e.prototype.removeChunksOutside=function(t,e){for(var n=this.chunks.length-1;n>=0;n--){var o=this.chunks[n],i=o.chunkSettings.position.chunksX,r=o.chunkSettings.position.chunksY;(i<t.chunksX||i>e.chunksX||r<t.chunksY||r>e.chunksY)&&(console.log(">>> REMOVING CHUNK ["+i+", "+r+"]"),this.chunks.splice(n,1))}},e.prototype.createMissingChunksInside=function(t,e){for(var n=function(n){for(var i=function(t){if(o.chunks.some((function(e){return e.chunkSettings.position.chunksX===n&&e.chunkSettings.position.chunksY===t})))return"continue";console.log(">>> CREATING CHUNK ["+n+", "+t+"]");var e=new s.Chunk(o.visualConsts,{position:{chunksX:n,chunksY:t}});e.mount(o.container),o.chunks.push(e)},r=t.chunksY;r<=e.chunksY;r++)i(r)},o=this,i=t.chunksX;i<=e.chunksX;i++)n(i)},e}(u.Mountable);e.Layer=l},879:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getChunkPosition=void 0,e.getChunkPosition=function(t,e){var n=t.chunkSize,o=t.tileSize,i=n.tilesWidth*o.pxWidth,r=n.tilesHeight*o.pxHeight,s=e.gamePxX,u=e.gamePxY;return{chunksX:Math.floor(s/i),chunksY:Math.floor(u/r)}}},907:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getGamePxPosition=void 0,e.getGamePxPosition=function(t,e){var n=t.chunkSize,o=t.tileSize,i=e.chunksX,r=e.chunksY;return{gamePxX:i*(n.tilesWidth*o.pxWidth),gamePxY:r*(n.tilesHeight*o.pxHeight)}}},698:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getViewPortGamePxCoords=void 0,e.getViewPortGamePxCoords=function(t,e){var n=e.center,o=t.viewPortSize,i=t.tileSize,r=o.tilesWidth*i.pxWidth,s=o.tilesHeight*i.pxHeight,u={gamePxX:Math.floor(n.gamePxX-r/2),gamePxY:Math.floor(n.gamePxY-s/2)};return{topLeft:u,bottomRight:{gamePxX:u.gamePxX+r,gamePxY:u.gamePxY+s}}}},923:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Mountable=void 0;var n=function(){function t(){}return t.prototype.mount=function(t,e){if(this.parent)throw new Error("Already mounted");t.appendChild(e),this.parent=t,this.current=e},t.prototype.unmount=function(t){this.parent&&this.current&&(this.parent.removeChild(t),this.parent=void 0,this.current=void 0)},t}();e.Mountable=n},751:function(t,e,n){var o,i=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ViewPort=void 0;var r=n(200),s=function(t){function e(e){var n=t.call(this)||this;n.container=document.createElement("div"),n.container.className="mmo-viewport";var o=e.viewPortSize,i=e.tileSize,s=o.tilesWidth*i.pxWidth,u=o.tilesHeight*i.pxHeight;return n.container.style.width=s+"px",n.container.style.height=u+"px",n.layer=new r.Layer(e),n.layer.mount(n.container),n.layer.syncChunks(),n.layer.__paintChunksRandomly(),n}return i(e,t),e.prototype.mount=function(e){t.prototype.mount.call(this,e,this.container)},e.prototype.unmount=function(){t.prototype.unmount.call(this,this.container)},e}(n(923).Mountable);e.ViewPort=s}},e={};function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{n(344);var t=n(751),e=document.createElement("div");document.body.appendChild(e),new t.ViewPort({tileSize:{pxWidth:128,pxHeight:128},viewPortSize:{tilesWidth:6,tilesHeight:6},chunkSize:{tilesWidth:6,tilesHeight:6}}).mount(e),console.log("Hello world")})()})();
//# sourceMappingURL=index.js.map
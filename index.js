(()=>{"use strict";var t={344:(t,e,n)=>{n.r(e)},187:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.randomColor=void 0;var o=n(233);e.randomColor=function(){var t=o.randomNumber(0,256),e=o.randomNumber(0,256),n=o.randomNumber(0,256);return"#"+t.toString(16).padStart(2,"0")+e.toString(16).padStart(2,"0")+n.toString(16).padStart(2,"0")}},233:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.randomNumber=void 0,e.randomNumber=function(t,e){return Math.floor(Math.random()*(e-t))+t}},201:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.sure=void 0,e.sure=function(t){if(null==t)throw new Error("value === null || value === undefined");return t}},474:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{s(o.next(t))}catch(t){i(t)}}function u(t){try{s(o.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((o=o.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Canvas=void 0;var u=n(201),s=function(t){function e(e){var n=t.call(this)||this;n.visualConsts=e,n.canvas=document.createElement("canvas");var o=e.tileSize,r=e.chunkSize,i=o.pxWidth*r.tilesWidth,a=o.pxHeight*r.tilesHeight;return n.canvas.width=i,n.canvas.height=a,n.context=u.sure(n.canvas.getContext("2d")),n}return r(e,t),e.prototype.mount=function(e){t.prototype.mount.call(this,e,this.canvas)},e.prototype.unmount=function(){t.prototype.unmount.call(this,this.canvas)},e.prototype.__fillTile=function(t,e,n){var o=this.visualConsts.tileSize,r=o.pxWidth*t,i=o.pxHeight*e;this.context.fillStyle=n,this.context.fillRect(r,i,o.pxWidth,o.pxHeight);var a=t+" / "+e;this.context.strokeStyle="#444",this.context.fillStyle="#fff",this.context.font="32px Arial",this.context.fillText(a,r+20,i+60),this.context.strokeText(a,r+20,i+60)},e.prototype.drawSprite=function(t,e){return i(this,void 0,void 0,(function(){return a(this,(function(n){switch(n.label){case 0:return[4,t.drawOnContext(this.context,e)];case 1:return n.sent(),[2]}}))}))},e}(n(923).Mountable);e.Canvas=s},37:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{s(o.next(t))}catch(t){i(t)}}function u(t){try{s(o.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((o=o.apply(t,e||[])).next())}))},a=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Chunk=void 0;var u=n(907),s=n(474),c=n(923),l=n(187),h=n(233),p=n(319),f=function(t){function e(e,n){var o=t.call(this)||this;o.visualConsts=e,o.chunkSettings=n,o.container=document.createElement("div"),o.container.className="mmo-chunk";var r=u.getGamePxPosition(e,n.position),i=r.gamePxX,a=r.gamePxY;return o.container.style.left=i+"px",o.container.style.top=a+"px",o.canvas=new s.Canvas(e),o.canvas.mount(o.container),o}return r(e,t),e.prototype.mount=function(e){t.prototype.mount.call(this,e,this.container)},e.prototype.unmount=function(){t.prototype.unmount.call(this,this.container)},e.prototype.__fillChunk=function(){return i(this,void 0,void 0,(function(){var t,e,n,o,r,i,u,s,c;return a(this,(function(a){switch(a.label){case 0:for(t=0;t<6;t++)for(e=0;e<6;e++)this.__fillTile(t,e,l.randomColor());n=this.visualConsts,o=n.chunkSize,r=n.tileSize,i=o.tilesWidth*r.pxWidth,u=o.tilesHeight*r.pxHeight,s=0,a.label=1;case 1:return s<5?(c={pxX:h.randomNumber(0,i),pxY:h.randomNumber(0,u)},[4,this.canvas.drawSprite(p.sprites.palm,c)]):[3,4];case 2:a.sent(),a.label=3;case 3:return s++,[3,1];case 4:return[2]}}))}))},e.prototype.__fillTile=function(t,e,n){this.canvas.__fillTile(t,e,n)},e}(c.Mountable);e.Chunk=f},200:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.Layer=void 0;var i=n(37),a=n(923),u=n(879),s=n(698),c=n(723),l=function(t){function e(e){var n=t.call(this)||this;return n.chunks=[],n.visualConsts=e,n.layerState={center:{gamePxX:0,gamePxY:0}},n.container=document.createElement("div"),n.container.className="mmo-layer",n.centerOn(n.layerState.center),n}return r(e,t),e.prototype.mount=function(e){t.prototype.mount.call(this,e,this.container)},e.prototype.unmount=function(){t.prototype.unmount.call(this,this.container)},e.prototype.centerOn=function(t){var e=t.gamePxX,n=t.gamePxY;this.layerState.center.gamePxX=e,this.layerState.center.gamePxY=n,this.syncChunks();var o=s.getViewPortGamePxCoords(this.visualConsts,this.layerState).topLeft;this.container.style.left=-o.gamePxX+"px",this.container.style.top=-o.gamePxY+"px"},e.prototype.syncChunks=function(){var t=s.getViewPortGamePxCoords(this.visualConsts,this.layerState),e=c.getBufferedViewPortGamePxCoords(this.visualConsts,t),n=u.getChunkPosition(this.visualConsts,e.topLeft),o=u.getChunkPosition(this.visualConsts,e.bottomRight);this.removeChunksOutside(n,o),this.createMissingChunksInside(n,o)},e.prototype.removeChunksOutside=function(t,e){for(var n=this.chunks.length-1;n>=0;n--){var o=this.chunks[n],r=o.chunkSettings.position.chunksX,i=o.chunkSettings.position.chunksY;(r<t.chunksX||r>e.chunksX||i<t.chunksY||i>e.chunksY)&&(console.log(">>> REMOVING CHUNK ["+r+", "+i+"]"),this.chunks[n].unmount(),this.chunks.splice(n,1))}},e.prototype.createMissingChunksInside=function(t,e){for(var n=function(n){for(var r=function(t){if(o.chunks.some((function(e){return e.chunkSettings.position.chunksX===n&&e.chunkSettings.position.chunksY===t})))return"continue";console.log(">>> CREATING CHUNK ["+n+", "+t+"]");var e=new i.Chunk(o.visualConsts,{position:{chunksX:n,chunksY:t}});e.mount(o.container),e.__fillChunk(),o.chunks.push(e)},a=t.chunksY;a<=e.chunksY;a++)r(a)},o=this,r=t.chunksX;r<=e.chunksX;r++)n(r)},e}(a.Mountable);e.Layer=l},723:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getBufferedViewPortGamePxCoords=void 0,e.getBufferedViewPortGamePxCoords=function(t,e){var n=t.bufferSizePx;return{topLeft:{gamePxX:e.topLeft.gamePxX-n,gamePxY:e.topLeft.gamePxY-n},bottomRight:{gamePxX:e.bottomRight.gamePxX+n,gamePxY:e.bottomRight.gamePxY+n}}}},879:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getChunkPosition=void 0,e.getChunkPosition=function(t,e){var n=t.chunkSize,o=t.tileSize,r=n.tilesWidth*o.pxWidth,i=n.tilesHeight*o.pxHeight,a=e.gamePxX,u=e.gamePxY;return{chunksX:Math.floor(a/r),chunksY:Math.floor(u/i)}}},907:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getGamePxPosition=void 0,e.getGamePxPosition=function(t,e){var n=t.chunkSize,o=t.tileSize,r=e.chunksX,i=e.chunksY;return{gamePxX:r*(n.tilesWidth*o.pxWidth),gamePxY:i*(n.tilesHeight*o.pxHeight)}}},698:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.getViewPortGamePxCoords=void 0,e.getViewPortGamePxCoords=function(t,e){var n=e.center,o=t.viewPortSize,r=t.tileSize,i=o.tilesWidth*r.pxWidth,a=o.tilesHeight*r.pxHeight,u={gamePxX:Math.floor(n.gamePxX-i/2),gamePxY:Math.floor(n.gamePxY-a/2)};return{topLeft:u,bottomRight:{gamePxX:u.gamePxX+i,gamePxY:u.gamePxY+a}}}},923:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Mountable=void 0;var n=function(){function t(){}return t.prototype.mount=function(t,e){if(this.parent)throw new Error("Already mounted");t.appendChild(e),this.parent=t,this.current=e},t.prototype.unmount=function(t){this.parent&&this.current&&(this.parent.removeChild(t),this.parent=void 0,this.current=void 0)},t}();e.Mountable=n},365:function(t,e){var n=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))((function(r,i){function a(t){try{s(o.next(t))}catch(t){i(t)}}function u(t){try{s(o.throw(t))}catch(t){i(t)}}function s(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}s((o=o.apply(t,e||[])).next())}))},o=this&&this.__generator||function(t,e){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=2&i[0]?o.return:i[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,i[1])).done)return r;switch(o=0,r&&(i=[2&i[0],r.value]),i[0]){case 0:case 1:r=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,o=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!r||i[1]>r[0]&&i[1]<r[3])){a.label=i[1];break}if(6===i[0]&&a.label<r[1]){a.label=r[1],r=i;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(i);break}r[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],o=0}finally{n=r=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0;var r=function(){function t(t){var e=this;this.img=document.createElement("img"),this.loaded=new Promise((function(t,n){e.img.addEventListener("error",n),e.img.addEventListener("load",(function(){return t()}))})),this.img.src=t}return t.prototype.drawOnContext=function(t,e){return n(this,void 0,void 0,(function(){var n,r;return o(this,(function(o){switch(o.label){case 0:return[4,this.loaded];case 1:return o.sent(),n=e.pxX,r=e.pxY,t.drawImage(this.img,n,r),[2]}}))}))},t}();e.Sprite=r},319:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.sprites=void 0;var o=n(365);e.sprites={palm:new o.Sprite(n(363))}},751:function(t,e,n){var o,r=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0}),e.ViewPort=void 0;var i=n(200),a=function(t){function e(e){var n=t.call(this)||this;n.container=document.createElement("div"),n.container.className="mmo-viewport";var o=e.viewPortSize,r=e.tileSize,a=o.tilesWidth*r.pxWidth,u=o.tilesHeight*r.pxHeight;return n.container.style.width=a+"px",n.container.style.height=u+"px",n.layer=new i.Layer(e),n.layer.mount(n.container),n}return r(e,t),e.prototype.mount=function(e){t.prototype.mount.call(this,e,this.container)},e.prototype.unmount=function(){t.prototype.unmount.call(this,this.container)},e.prototype.centerOn=function(t){this.layer.centerOn(t)},e}(n(923).Mountable);e.ViewPort=a},363:(t,e,n)=>{t.exports=n.p+"273c9e9a4f3952a76cd0.png"}},e={};function n(o){var r=e[o];if(void 0!==r)return r.exports;var i=e[o]={exports:{}};return t[o].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var o=e.getElementsByTagName("script");o.length&&(t=o[o.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),(()=>{n(344);var t=n(751),e=document.createElement("div");document.body.appendChild(e);var o=new t.ViewPort({bufferSizePx:256,tileSize:{pxWidth:128,pxHeight:128},viewPortSize:{tilesWidth:6,tilesHeight:6},chunkSize:{tilesWidth:6,tilesHeight:6}});o.mount(e);var r=0,i=0;document.addEventListener("keydown",(function(t){var e=t.code,n=0,a=0;switch(e){case"ArrowUp":a=-20;break;case"ArrowDown":a=20;break;case"ArrowLeft":n=-20;break;case"ArrowRight":n=20;break;default:return}r+=n,i+=a,console.log("CODE: "+e+", x: "+r+", y: "+i),o.centerOn({gamePxX:r,gamePxY:i})})),console.log("Hello world")})()})();
//# sourceMappingURL=index.js.map